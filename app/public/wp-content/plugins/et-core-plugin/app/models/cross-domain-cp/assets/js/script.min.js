"use strict";window.XdUtils=window.XdUtils||{extend:function(e,t){var n,o=t||{};for(n in e)e.hasOwnProperty(n)&&(o[n]=e[n]);return o}},window.xdLocalStorage=window.xdLocalStorage||function(){function t(e){var t;try{t=JSON.parse(e.data)}catch(e){}t&&t.namespace===r&&("iframe-ready"===t.id?(u=!0,s.initCallback()):d[(e=t).id]&&(d[e.id](e),delete d[e.id]))}function o(e,t,n,o){d[++c]=o;o={namespace:r,id:c,action:e,key:t,value:n};l.contentWindow.postMessage(JSON.stringify(o),"*")}function n(e){s=XdUtils.extend(e,s);e=document.createElement("div");window.addEventListener?window.addEventListener("message",t,!1):window.attachEvent("onmessage",t),e.innerHTML='<iframe id="'+s.iframeId+'" src='+s.iframeUrl+' style="display: none;"></iframe>',document.body.appendChild(e),l=document.getElementById(s.iframeId)}function i(){return m?u||(console.log("You must wait for iframe ready message before using the api."),0):(console.log("You must call xdLocalStorage.init() before using it."),0)}function a(){return"complete"===document.readyState}var l,r="cross-domain-local-message",s={iframeId:"cross-domain-iframe",iframeUrl:void 0,initCallback:function(){}},c=-1,d={},m=!1,u=!0;return{init:function(e){if(!e.iframeUrl)throw"You must specify iframeUrl";m?console.log("xdLocalStorage was already initialized!"):(m=!0,a()?n(e):document.addEventListener?document.addEventListener("readystatechange",function(){a()&&n(e)}):document.attachEvent("readystatechange",function(){a()&&n(e)}))},setItem:function(e,t,n){i()&&o("set",e,t,n)},getItem:function(e,t){i()&&o("get",e,null,t)},removeItem:function(e,t){i()&&o("remove",e,null,t)},key:function(e,t){i()&&o("key",e,null,t)},getSize:function(e){i()&&o("size",null,null,e)},getLength:function(e){i()&&o("length",null,null,e)},clear:function(e){i()&&o("clear",null,null,e)},wasInit:function(){return m}}}(),function(o,m){var u={init:function(e){u.hasContent=!1,u.templatePasteButton=!1,u.loadxdLocalStorage(),u.loadContextMenuGroupsHooks(),u.allowDisallowPasteAction()},loadxdLocalStorage:function(){xdLocalStorage.init({iframeUrl:"https://xstore.8theme.com/cross-domain-cp/index.html",initCallback:function(){}})},loadContextMenuGroupsHooks:function(){m.each(["section","widget","column"],function(e,t){elementor.hooks.addFilter("elements/"+t+"/contextMenuGroups",function(e,t){return u.prepareMenuItem(e,t)})})},prepareMenuItem:function(e,t){var n=_.findIndex(e,function(e){return"clipboard"===e.name});return e.splice(n+1,0,{name:"etheme-elementor-live-paste",actions:[{name:"etheme-live-paste",title:u.getText("live_paste"),icon:"eicon-copy",shortcut:u.getText("live_paste_label"),callback:function(){u.livePaste(t)}},{name:"etheme-live-copy-templates",title:u.getText("find_templates"),icon:"eicon-parallax",shortcut:u.getText("live_paste_label"),callback:function(){o.open("https://xstore.8theme.com/elementor/demos/minimal-fashion02/design-elements/","_blank")}}]}),e},allowDisallowPasteAction:function(){void 0!==DialogsManager.Widget.prototype.onShow&&(DialogsManager.Widget.prototype.onShow=function(){u.getContent()})},getContent:function(){xdLocalStorage.getItem("etheme-cross-domain-cp",function(e){e.value?(m(".elementor-context-menu-list__item-etheme-live-paste").removeClass("etheme-menu-list__item--disabled"),m(".elementor-etheme-live-paste").removeClass("etheme-elementor-add-section-area-button-disabled")):(m(".elementor-context-menu-list__item-etheme-live-paste").addClass("etheme-menu-list__item--disabled"),m(".elementor-etheme-live-paste").addClass("etheme-elementor-add-section-area-button-disabled")),u.hasContent=!!e.value})},getText:function(e){return etheme_cross_domain_cp_config.texts[e]},livePaste:function(d){return xdLocalStorage.getItem("etheme-cross-domain-cp",function(e){if(e.value){var t,e=JSON.parse(e.value),n=JSON.stringify(e),o=null,i={};if(u.templatePasteButton){var a=m(d.target).parents(".elementor-add-section"),l=a.prev(".elementor-top-section"),r=a.next(".elementor-top-section");l.length?i.at=l.index()+1:r.length&&(i.at=r.index()-1),t=elementor.getPreviewContainer(),a.find(".elementor-add-section-close").click()}else{switch(d.model.get("elType")){case"column":o=d.getContainer().parent;break;case"widget":o=d.getContainer().parent.parent;break;case"section":o=d.getContainer()}if(null===o)return;o.model.attributes.isInner&&(o=o.parent.parent),t=o.parent,i.at=o.view.getOption("_index")+1}var s={elType:"section",settings:e.settings,elements:e.elements,isInner:!1},c=(elementor.channels.data.trigger("element:before:add",{elType:"section"}),$e.run("document/elements/create",{container:t,model:s,options:i}));elementor.channels.data.trigger("element:after:add"),m.each(["fa-solid","fa-regular"],function(e,t){elementor.helpers.enqueueIconFonts(t)}),m.ajax({url:etheme_cross_domain_cp_config.ajax_url,method:"POST",data:{action:"etheme_cross_domain_cp_import",data:n,nonce:etheme_cross_domain_cp_config.nonce},beforeSend:function(){c.view.$el.append('<div class="etheme-cross-domain-cp-ixporting">'+u.getText("processing")+"</div>")}}).done(function(e){e.success&&(e=e.data[0],s.settings=e.settings,s.elType=e.elType,"widget"===e.elType?s.widgetType=e.widgetType:s.elements=e.elements,setTimeout(function(){$e.run("document/elements/delete",{container:c});$e.run("document/elements/create",{model:s,container:t,options:i})},800),m(".etheme-cross-domain-cp-ixporting").remove())}),u.templatePasteButton=!1}else alert(u.getText("not_allowed"))})}},e=navigator.userAgent;function n(e){e=e.find(".elementor-add-new-section .elementor-add-section-drag-title");e.length&&e.before('<div class="elementor-add-section-area-button elementor-etheme-live-paste mtips mtips-top" title="'+etheme_cross_domain_cp_config.texts.live_paste+'">\n\t\t\t\t<i class="eicon-copy"></i>\n\t\t\t\t<span class="mt-mes">'+etheme_cross_domain_cp_config.texts.live_paste+"</span>\n\t\t\t</div>")}function i(e){e=e.find(".elementor-select-preset-list");e.length&&e.after('<div class="elementor-add-section-drag-title elementor-etheme-add-section-title">'+etheme_cross_domain_cp_config.texts.live_paste_info+"</div>")}e=-1<e.indexOf("Firefox")?"Mozilla Firefox":-1<e.indexOf("Opera")?"Opera":-1<e.indexOf("Trident")?"Microsoft Internet Explorer":-1<e.indexOf("Edge")?"Microsoft Edge":-1<e.indexOf("Chrome")?"Google Chrome or Chromium":-1<e.indexOf("Safari")?"Apple Safari":"unknown",-1<m.inArray(e,["Apple Safari","unknown"])||o.elementor&&(u.init(),o.elementor.on("preview:loaded",function(){var e=o.elementor.$previewContents,t=setInterval(function(){n(e),i(e),0<e.find(".elementor-add-new-section").length&&clearInterval(t)},100);e.on("click.onAddElement",".elementor-editor-section-settings .elementor-editor-element-add",function(e){let t=m(this).closest(".elementor-top-section").prev(".elementor-add-section");u.templatePasteButton=!0,setTimeout(function(){t.find(".elementor-etheme-live-paste").length||n(t),t.find(".elementor-etheme-add-section-title").length||i(t)},500)}),e.on("click.onAddElement",".elementor-editor-container-settings .elementor-editor-element-add",function(e){let t=m(this).closest(".e-con").prev(".elementor-add-section");u.templatePasteButton=!0,setTimeout(function(){t.find(".elementor-etheme-live-paste").length||n(t),t.find(".elementor-etheme-add-section-title").length||i(t)},500)}),e.on("click.onAddTemplateButton",".elementor-etheme-live-paste",function(e){u.templatePasteButton=!0,u.livePaste(e)})}.bind(this)))}(window,(document,jQuery),xdLocalStorage);